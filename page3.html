
<script>
/* ------------------------------
   SETUP
--------------------------------*/
const players = JSON.parse(localStorage.getItem("players") || "[]");
if (players.length === 0) {
  alert("No player data found â€” returning to start!");
  window.location.href = "page1.html";
}

const colors = ["red", "blue", "green", "yellow"];
const board = document.getElementById("board");
const sidebar = document.getElementById("playerSidebar");
const diceDisplay = document.getElementById("diceDisplay");

// Assign starting info
players.forEach((p, i) => {
  p.balance = 1500;
  p.position = 0;
  p.color = colors[i];
});

/* ------------------------------
   DISPLAY SIDEBAR
--------------------------------*/
function renderSidebar(activeIndex = 0) {
  sidebar.innerHTML = "";
  players.forEach((p, i) => {
    const card = document.createElement("div");
    card.classList.add("player-card");
    if (i === activeIndex) card.classList.add("active");
    card.style.borderLeftColor = p.color;
    card.innerHTML = `
      <div class="player-name">${p.name}</div>
      <div class="player-balance">ðŸ’µ $${p.balance}</div>
    `;
    sidebar.appendChild(card);
  });
}

/* ------------------------------
   CREATE PLAYER TOKENS
--------------------------------*/
const tokenMap = new Map();

players.forEach((p) => {
  const token = document.createElement("div");
  token.classList.add("player-token");
  token.style.backgroundColor = p.color;
  board.appendChild(token);
  tokenMap.set(p.name, token);
});

/* ------------------------------
   MOVE PLAYER TOKEN
--------------------------------*/
const tilePositions = [
  { bottom: "5%", right: "5%" }, // GO
  { bottom: "5%", right: "15%" },
  { bottom: "5%", right: "25%" },
  { bottom: "5%", right: "35%" },
  { bottom: "5%", right: "45%" },
  { bottom: "5%", right: "55%" },
  { bottom: "5%", right: "65%" },
  { bottom: "5%", right: "75%" },
  { bottom: "5%", right: "85%" },
  { bottom: "5%", right: "95%" },
  { bottom: "15%", right: "95%" },
  // Add more coordinates as needed for 40 tiles
];

function moveToken(player, steps) {
  player.position = (player.position + steps) % tilePositions.length;
  const pos = tilePositions[player.position];
  const token = tokenMap.get(player.name);
  token.style.bottom = pos.bottom;
  token.style.right = pos.right;
}

/* ------------------------------
   GAME TURN SYSTEM
--------------------------------*/
let turn = 0;
renderSidebar(turn);

function nextTurn() {
  turn = (turn + 1) % players.length;
  renderSidebar(turn);
}

/* ------------------------------
   BUTTON HANDLERS
--------------------------------*/
document.getElementById("rollBtn").addEventListener("click", () => {
  const dice = Math.floor(Math.random() * 6) + 1 + Math.floor(Math.random() * 6) + 1;
  diceDisplay.textContent = dice;
  const current = players[turn];
  moveToken(current, dice);
});

document.getElementById("endTurnBtn").addEventListener("click", nextTurn);
document.getElementById("buyBtn").addEventListener("click", () => alert("Property bought (placeholder)!"));
document.getElementById("useCardBtn").addEventListener("click", () => alert("Used jail card (placeholder)!"));
</script>
</body>
</html>
