<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>UBHACKOPOLY ‚Äì Game Board</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }

  html, body {
    height: 100%;
    font-family: "Poppins", sans-serif;
    background: radial-gradient(circle at top, #0b1335, #02040a 85%);
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }

  .game-container {
    display: grid;
    grid-template-columns: 22% 53% 25%;
    width: 96vw;
    height: 96vh;
    gap: 1rem;
  }

  /* Sidebar (players) */
  .sidebar {
    backdrop-filter: blur(18px);
    background: rgba(255, 255, 255, 0.08);
    border: 2px solid rgba(255, 255, 255, 0.15);
    border-radius: 20px;
    padding: 1rem;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
    overflow-y: auto;
  }
  .sidebar h2 {
    text-align: center;
    font-size: 1.3rem;
    margin-bottom: 10px;
    color: #00c0ff;
    text-shadow: 0 0 10px rgba(0,180,255,0.8);
  }

  .player-card {
    background: rgba(255,255,255,0.08);
    border-radius: 10px;
    margin-bottom: 0.6rem;
    padding: 0.8rem;
    border-left: 5px solid;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.3s ease;
  }
  .player-card.active {
    background: linear-gradient(135deg, #007bff, #5e1fff);
    transform: scale(1.03);
    box-shadow: 0 0 14px #2196f3cc;
  }
  .player-info { flex: 1; }
  .player-name { font-weight: 700; font-size: 1rem; }
  .player-balance { font-size: 0.85rem; opacity: 0.9; }

  .player-piece { width: 42px; height: 42px; display: grid; place-items: center; }
  .player-piece img { width: 36px; height: 36px; object-fit: contain; filter: drop-shadow(0 2px 6px rgba(0,0,0,.4)); }

  /* The Board */
  .board {
    position: relative;
    display: grid;
    grid-template-columns: repeat(11, 1fr);
    grid-template-rows: repeat(11, 1fr);
    width: 100%;
    height: 100%;
    background: #00142e;
    border: 5px solid #00aaff;
    border-radius: 18px;
    box-shadow: 0 0 30px rgba(0, 150, 255, 0.5);
    overflow: hidden;
  }

  .tile {
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid rgba(255, 255, 255, 0.2);
    font-size: clamp(8px, 0.9vw, 13px);
    text-align: center;
    padding: 3px;
    cursor: pointer;
    transition: all 0.25s ease;
    user-select: none;
  }
  .tile:hover {
    transform: scale(1.06);
    z-index: 5;
    background: rgba(0, 200, 255, 0.2);
    box-shadow: 0 0 12px rgba(0, 255, 255, 0.6);
  }
  .tile:active {
    transform: scale(0.98);
    background: rgba(0, 150, 255, 0.35);
    box-shadow: 0 0 20px rgba(0, 150, 255, 0.8);
  }

  .corner { font-weight: bold; background: linear-gradient(145deg, #007bff, #001f5a); color: white; }
  .chance { background: #a78b1d; color: #fff; }
  .community { background: #007e33; color: white; }
  .bus { background: #5f5f5f; color: white; }
  .fees { background: #9c174d; color: white; }

  /* Board layout (GO bottom-left clockwise) */
  #go { grid-row: 11; grid-column: 11; }
  #justVisiting { grid-row: 11; grid-column: 1; }
  #freeParking { grid-row: 1; grid-column: 1; }
  #goToJail { grid-row: 1; grid-column: 11; }

  /* Bottom row */
  #baird { grid-row: 11; grid-column: 10; }
  #community1 { grid-row: 11; grid-column: 9; }
  #clements { grid-row: 11; grid-column: 8; }
  #saFees { grid-row: 11; grid-column: 7; }
  #northBus { grid-row: 11; grid-column: 6; }
  #baldy { grid-row: 11; grid-column: 5; }
  #chance1 { grid-row: 11; grid-column: 4; }
  #jacobs { grid-row: 11; grid-column: 3; }
  #park { grid-row: 11; grid-column: 2; }

  /* Right column */
  #obrian { grid-row: 10; grid-column: 1; }
  #mtBanks { grid-row: 9; grid-column: 1; }
  #norton { grid-row: 8; grid-column: 1; }
  #knox { grid-row: 7; grid-column: 1; }
  #southBus { grid-row: 6; grid-column: 1; }
  #bonner { grid-row: 5; grid-column: 1; }
  #community2 { grid-row: 4; grid-column: 1; }
  #talbert { grid-row: 3; grid-column: 1; }
  #hochstetter { grid-row: 2; grid-column: 1; }

  /* Top row */
  #cooke { grid-row: 1; grid-column: 2; }
  #chance2 { grid-row: 1; grid-column: 3; }
  #fronczak { grid-row: 1; grid-column: 4; }
  #nsc { grid-row: 1; grid-column: 5; }
  #downtownBus { grid-row: 1; grid-column: 6; }
  #ketter { grid-row: 1; grid-column: 7; }
  #slee { grid-row: 1; grid-column: 8; }
  #valmar { grid-row: 1; grid-column: 9; }
  #furnas { grid-row: 1; grid-column: 10; }

  /* Left column */
  #theCommons { grid-row: 2; grid-column: 11; }
  #centerArts { grid-row: 3; grid-column: 11; }
  #community3 { grid-row: 4; grid-column: 11; }
  #alumniArena { grid-row: 5; grid-column: 11; }
  #shoppingBus { grid-row: 6; grid-column: 11; }
  #chance3 { grid-row: 7; grid-column: 11; }
  #davis { grid-row: 8; grid-column: 11; }
  #textbookFees { grid-row: 9; grid-column: 11; }
  #jarvis { grid-row: 10; grid-column: 11; }

  /* Actions panel */
  .actions {
    backdrop-filter: blur(18px);
    background: rgba(255, 255, 255, 0.08);
    border: 2px solid rgba(255, 255, 255, 0.15);
    border-radius: 20px;
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: flex-start;
    gap: 16px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
  }
  .actions button {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 12px;
    background: linear-gradient(135deg, #007bff, #4a00e0);
    color: white;
    font-weight: 700;
    font-size: 1rem;
    cursor: pointer;
    box-shadow: 0 0 18px rgba(0,136,255,0.3);
    transition: all 0.3s ease;
  }
  .actions button:hover {
    background: linear-gradient(135deg, #00b0ff, #5e1fff);
    transform: translateY(-2px);
    box-shadow: 0 0 25px rgba(90,50,255,0.6);
  }
  .dice-display { text-align:center; font-weight:700; opacity:.9; }

  /* Popup / notification */
  .popup {
    position: fixed;
    top: 20px;
    right: 20px;
    background: linear-gradient(135deg, #007bff, #00b3ff);
    color: white;
    padding: 15px 22px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 1rem;
    box-shadow: 0 0 25px rgba(0, 180, 255, 0.5);
    opacity: 0;
    transform: translateY(-20px);
    transition: all 0.4s ease;
    z-index: 999;
  }
  .popup.show { opacity: 1; transform: translateY(0); }

  /* ===== Center slanted logo ===== */
  .center-overlay{
    position:absolute;
    left:50%; top:50%;
    transform: translate(-50%,-50%) rotate(-12deg);
    z-index: 8; /* below corner buttons */
    pointer-events: none;
  }
  .center-logo{
    width: clamp(260px, 38vw, 520px);
    height:auto;
    filter: drop-shadow(0 12px 28px rgba(0,0,0,.35));
    user-select:none;
  }

  /* ===== Diagonal card buttons ===== */
  .corner-card {
    position: absolute;
    z-index: 12;
    pointer-events: auto;
    appearance:none;
    border: 2px solid #ffd166;
    background: rgba(0,0,0,.28);
    color:#ffd166;
    font-weight:800;
    letter-spacing:.06em;
    padding: 14px 18px;
    border-radius: 14px;
    text-transform: uppercase;
    box-shadow: 0 10px 26px rgba(0,0,0,.35);
    cursor:pointer;
    transition: transform .15s ease, box-shadow .15s ease, background .15s ease, color .15s ease, border-color .15s ease, opacity .15s ease;
    transform: rotate(-8deg);
  }
  .corner-card:hover { transform: rotate(-8deg) translateY(-2px); background: rgba(255,209,102,.12); color:#fff0c2; border-color:#ffe39b; }

  /* Community Chest color theme */
  #communityBtnBR { border-color:#7ecbff; color:#7ecbff; }
  #communityBtnBR:hover { background: rgba(126,203,255,.12); color:#e7f5ff; border-color:#bde4ff; }

  @media (max-width: 900px){
    .corner-card { padding: 12px 14px; }
  }
</style>
</head>
<body>
<div class="game-container">
  <div class="sidebar" id="playerSidebar"><h2>üéÆ Players</h2></div>

  <div class="board" id="board">
    <!-- Center slanted logo -->
    <div class="center-overlay" id="centerLogoWrap">
      <img class="center-logo" id="centerLogo" src="Images/UBHACK logo.png" alt="UBHACKOPOLY" />
    </div>

    <!-- Diagonal buttons (positioned via JS) -->
    <button id="chanceBtnTL" class="corner-card">Chance</button>
    <button id="communityBtnBR" class="corner-card">Community Chest</button>

    <!-- Corners -->
    <div class="tile corner" id="go">GO</div>
    <div class="tile corner" id="justVisiting">Just Visiting</div>
    <div class="tile corner" id="freeParking">Free Parking</div>
    <div class="tile corner" id="goToJail">Go To Jail</div>

    <!-- Bottom row -->
    <div class="tile" id="baird">Baird</div>
    <div class="tile community" id="community1">Community Chest</div>
    <div class="tile" id="clements">Clements</div>
    <div class="tile fees" id="saFees">SA Fees</div>
    <div class="tile bus" id="northBus">North Bus</div>
    <div class="tile" id="baldy">Baldy</div>
    <div class="tile chance" id="chance1">Chance</div>
    <div class="tile" id="jacobs">Jacobs</div>
    <div class="tile" id="park">Park</div>

    <!-- Right -->
    <div class="tile" id="obrian">O‚ÄôBrian</div>
    <div class="tile" id="mtBanks">M&T Banks</div>
    <div class="tile" id="norton">Norton</div>
    <div class="tile" id="knox">Knox</div>
    <div class="tile bus" id="southBus">South Bus</div>
    <div class="tile" id="bonner">Bonner</div>
    <div class="tile community" id="community2">Community Chest</div>
    <div class="tile" id="talbert">Talbert</div>
    <div class="tile" id="hochstetter">Hochstetter</div>

    <!-- Top -->
    <div class="tile" id="cooke">Cooke</div>
    <div class="tile chance" id="chance2">Chance</div>
    <div class="tile" id="fronczak">Fronczak</div>
    <div class="tile" id="nsc">NSC</div>
    <div class="tile bus" id="downtownBus">Downtown Bus</div>
    <div class="tile" id="ketter">Ketter</div>
    <div class="tile" id="slee">Slee</div>
    <div class="tile" id="valmar">Valmar</div>
    <div class="tile" id="furnas">Furnas</div>

    <!-- Left -->
    <div class="tile" id="theCommons">The Commons</div>
    <div class="tile" id="centerArts">Center for the Arts</div>
    <div class="tile community" id="community3">Community Chest</div>
    <div class="tile" id="alumniArena">Alumni Arena</div>
    <div class="tile bus" id="shoppingBus">Shopping Bus</div>
    <div class="tile chance" id="chance3">Chance</div>
    <div class="tile" id="davis">Davis</div>
    <div class="tile fees" id="textbookFees">Textbook Fees</div>
    <div class="tile" id="jarvis">Jarvis</div>
  </div>

  <div class="actions">
    <button id="rollBtn">üé≤ Roll Dice</button>
    <div class="dice-display" id="diceDisplay">‚Äì</div>
    <button id="buyBtn">üí∞ Buy Property</button>
    <button id="useCardBtn">üéüÔ∏è Use Jail Card</button>
    <button id="endTurnBtn">‚û°Ô∏è End Turn</button>
  </div>
</div>

<div class="popup" id="popup">Notification</div>

<script>
/* ---- Pull players from sessionStorage (set by page 2) ---- */
function loadPlayersFromStorage() {
  try {
    const stored = JSON.parse(sessionStorage.getItem('players') || '[]');
    const count = parseInt(sessionStorage.getItem('playerCount') || '0', 10);

    if (Array.isArray(stored) && stored.length > 0) {
      const palette = ["#00bfff", "#ff4b5c", "#ffd700", "#00ff88", "#ff9f1c", "#9b5de5"];
      return stored.slice(0, Math.max(count, stored.length)).map((p, idx) => ({
        name: p.name || `Player ${idx+1}`,
        color: palette[idx % palette.length],
        balance: 1500,
        pieceFile: p.piece || null
      }));
    }
  } catch (e) { /* ignore and fall back */ }

  return [
    { name: "Player 1", color: "#00bfff", balance: 1500, pieceFile: "busPiece.png" },
    { name: "Player 2", color: "#ff4b5c", balance: 1500, pieceFile: "wingPiece.png" },
    { name: "Player 3", color: "#ffd700", balance: 1500, pieceFile: "mascotPiece.png" },
    { name: "Player 4", color: "#00ff88", balance: 1500, pieceFile: "turkeyPiece.png" },
  ];
}

let players = loadPlayersFromStorage();
let activePlayer = 0;

function pieceMarkup(p) {
  const src = p.pieceFile ? `Images/${p.pieceFile}` : "";
  return src ? `<img src="${src}" alt="${p.name} piece" />` : "üé≤";
}

function renderSidebar() {
  const sidebar = document.getElementById("playerSidebar");
  sidebar.innerHTML = `<h2>üéÆ Players</h2>`;
  players.forEach((p, i) => {
    const card = document.createElement("div");
    card.classList.add("player-card");
    if (i === activePlayer) card.classList.add("active");
    card.style.borderLeftColor = p.color;
    card.innerHTML = `
      <div class="player-info">
        <div class="player-name">${p.name}</div>
        <div class="player-balance">üíµ $${p.balance}</div>
      </div>
      <div class="player-piece">${pieceMarkup(p)}</div>
    `;
    sidebar.appendChild(card);
  });
}
renderSidebar();

/* ---- Make Tiles Clickable ---- */
document.querySelectorAll(".tile").forEach(tile => {
  tile.addEventListener("click", () => {
    const name = tile.textContent.trim();
    showPopup(`${players[activePlayer].name} clicked ${name}!`, "#00bfff");
  });
  tile.addEventListener("mouseenter", () => { tile.style.filter = "brightness(1.3)"; });
  tile.addEventListener("mouseleave", () => { tile.style.filter = "brightness(1)"; });
});

/* ---- Diagonal buttons click handlers ---- */
document.getElementById('chanceBtnTL').addEventListener('click', () => {
  showPopup(`${players[activePlayer].name} drew a Chance card!`, "#a78b1d");
});
document.getElementById('communityBtnBR').addEventListener('click', () => {
  showPopup(`${players[activePlayer].name} opened Community Chest!`, "#2aa0ff");
});

/* ---- Position the diagonal buttons ~25px from the logo,
        nudged (Chance RIGHT/DOWN, Community LEFT/UP) ---- */
function positionCornerButtons() {
  const board  = document.getElementById('board');
  const logo   = document.getElementById('centerLogo');
  const chance = document.getElementById('chanceBtnTL');
  const comm   = document.getElementById('communityBtnBR');

  const GAP = 25;       // base distance from logo edge
  const CHANCE_DX = 200; // move Chance RIGHT
  const CHANCE_DY = 40; // move Chance DOWN
  const COMM_DX   = -200; // move Community LEFT
  const COMM_DY   = -40; // move Community UP

  const boardRect  = board.getBoundingClientRect();
  const logoRect   = logo.getBoundingClientRect();
  const chanceRect = chance.getBoundingClientRect();
  const commRect   = comm.getBoundingClientRect();

  // Chance near logo's top-left
  let chanceTop  = (logoRect.top  - boardRect.top) - GAP - chanceRect.height + CHANCE_DY;
  let chanceLeft = (logoRect.left - boardRect.left) - GAP - chanceRect.width  + CHANCE_DX;

  // Community near logo's bottom-right
  let commTop  = (logoRect.bottom - boardRect.top) + GAP + COMM_DY;
  let commLeft = (logoRect.right  - boardRect.left) + GAP + COMM_DX;

  // Clamp inside board (8px padding)
  chanceTop  = Math.max(8, Math.min(boardRect.height - chanceRect.height - 8, chanceTop));
  chanceLeft = Math.max(8, Math.min(boardRect.width  - chanceRect.width  - 8, chanceLeft));
  commTop    = Math.max(8, Math.min(boardRect.height - commRect.height - 8, commTop));
  commLeft   = Math.max(8, Math.min(boardRect.width  - commRect.width  - 8, commLeft));

  chance.style.top  = `${chanceTop}px`;
  chance.style.left = `${chanceLeft}px`;
  comm.style.top    = `${commTop}px`;
  comm.style.left   = `${commLeft}px`;
}

// Recalculate on load/resize & after logo loads
window.addEventListener('load', positionCornerButtons);
window.addEventListener('resize', positionCornerButtons);
const centerLogo = document.getElementById('centerLogo');
centerLogo.complete ? positionCornerButtons() : centerLogo.addEventListener('load', positionCornerButtons);

/* ---- Popup helper ---- */
function showPopup(message, color="#00bfff") {
  const popup = document.getElementById("popup");
  popup.textContent = message;
  popup.style.background = `linear-gradient(135deg, ${color}, #00b3ff)`;
  popup.classList.add("show");
  setTimeout(() => popup.classList.remove("show"), 2000);
}

/* ---- Action buttons ---- */
document.getElementById("rollBtn").onclick = () => {
  const roll = Math.floor(Math.random() * 6) + 1;
  document.getElementById("diceDisplay").textContent = `üé≤ ${roll}`;
  showPopup(`${players[activePlayer].name} rolled a ${roll}!`, "#00ffcc");
};
document.getElementById("buyBtn").onclick = () => {
  showPopup(`${players[activePlayer].name} bought a property!`, "#ffb300");
};
document.getElementById("useCardBtn").onclick = () => {
  showPopup(`${players[activePlayer].name} used a jail card!`, "#ff5c93");
};
document.getElementById("endTurnBtn").onclick = () => {
  activePlayer = (activePlayer + 1) % players.length;
  renderSidebar();
  showPopup(`Turn ended. ${players[activePlayer].name}'s turn!`, "#4a9eff");
};
</script>
</body>
</html>
